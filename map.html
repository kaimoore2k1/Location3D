<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
	<title>Smartcity - Building Map</title>

	<style>
		html,
		body,
		#viewDiv {
			padding: 0;
			margin: 0;
			height: 100%;
			width: 100%;
		}

		#back {
			position: absolute;
			bottom: 20px;
		}

		#back i {
			background-image: url(app/public/img/back.svg);
			background-repeat: no-repeat;
			display: inline-block;
			width: 100px;
			height: 25px;
			padding-left: 25px;
			padding-top: 2px;
			margin: 10px;
			cursor: pointer;
			background-size: 20px;
		}
	</style>

	<link rel="stylesheet" href="https://js.arcgis.com/4.16/esri/themes/light/main.css" />
	<script src="https://js.arcgis.com/4.16/"></script>

	<script>
		require([
			"esri/Map",
			"esri/views/SceneView",
			"esri/layers/GeoJSONLayer",
			"esri/layers/SceneLayer", "esri/layers/GraphicsLayer", "esri/Graphic", "esri/request"
		], function (Map, SceneView, GeoJSONLayer, SceneLayer,
			GraphicsLayer, Graphic, esriRequest) {
			var createGraphic = function (data) {
				return new Graphic({
					geometry: data,
					symbol: data.symbol,
					attributes: data,
					popupTemplate: data.popupTemplate
				});
			};

			const json_options = {
				query: {
					f: "json"
				},
				responseType: "json"
			};
			// request json
			esriRequest('./data.json', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});
				map.add(graphicsLayer);

			});
			// geojson layer
			const geojsonLayer = new GeoJSONLayer({
				url: "./data.geojson"
			});

			geojsonLayer.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			const geojsonLayer2 = new GeoJSONLayer({
				url: "./data2.geojson"
			});
			geojsonLayer2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.05,
							material: {
								color: "(255,255,255,0.5)"
							}
						}
					]
				}
			};

			const map = new Map({
				basemap: "topo-vector",
				ground: "world-elevation",
				layers: [geojsonLayer] //end layers
			});
			const geojsonLayer3 = new GeoJSONLayer({
				url: "./data3.geojson"
			});
			geojsonLayer3.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			const tang123 = new GeoJSONLayer({
				url: "./tang123.geojson"
			});
			tang123.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3,
							material: {
								color: "#ccc"
							}
						}
					]
				}
			};
			

			const tang_13 = new GeoJSONLayer({
				url: "./Tang_13.geojson"
			});
			tang_13.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 5,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			const Col123 = new GeoJSONLayer({
          		url: "./datacol.geojson",
        	});
			Col123.renderer = {
			type: "simple",
			symbol: {
				type: "polygon-3d",
				symbolLayers: [
				{
					type: "extrude",
					size: 9,
					material: {
					color: "red",
					},
				},
				],
			},
			};
			const matbang = new GeoJSONLayer({
          		url: "./mat_bang.geojson",
        	});
			matbang.renderer = {
			type: "simple",
			symbol: {
				type: "polygon-3d",
				symbolLayers: [
				{
					type: "extrude",
					size: 2,
					material: {
					color: "#7eadf7",
					},
				},
				],
			},
			};

			const vienNgangMatTruoc = new GeoJSONLayer({
				url: "./MatTruoc/vien-ngang-mat-truoc.geojson"
			});
			vienNgangMatTruoc.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 32,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};

			const cuaSoVienNgang = new GeoJSONLayer({
				url: "./MatTruoc/cua-so-vien-ngang.geoJson"
			});
			cuaSoVienNgang.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.1,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};
			const lineDoc = new GeoJSONLayer({
				url: "./linedoc.geojson"
			});
			lineDoc.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};
			const lineDocTren = new GeoJSONLayer({
				url: "./linedoctren.geojson"
			});
			lineDocTren.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 33,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};
			const lineNgang = new GeoJSONLayer({
				url: "./linengang.geojson"
			});
			lineNgang.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.1,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};

			const cuaSoVienDoc = new GeoJSONLayer({
				url: "./MatTruoc/cua-so-vien-doc.geojson"
			});
			cuaSoVienDoc.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.6,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};

			const mayCheTang1 = new GeoJSONLayer({
				url: "./MatTruoc/mai-che-tang-1.geojson"
			});
			mayCheTang1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.2,
							material: {
								color: "#fff"
							}
						}
					]
				}
			};

			const stairs = new GeoJSONLayer({
				url: "./Stair/stair.geojson"
			});
			stairs.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.15,
							material: {
								color: "red"
							}
						}
					]
				}
			};

			map.layers.add(geojsonLayer2)
			map.layers.add(geojsonLayer3)
			map.layers.add(tang123)
			map.layers.add(tang_13)
			map.layers.add(cuaSoVienNgang)
			map.layers.add(cuaSoVienDoc)
			map.layers.add(vienNgangMatTruoc)
			map.layers.add(mayCheTang1)
			map.layers.add(Col123)
		     map.layers.add(matbang)
			map.layers.add(lineDoc)
			map.layers.add(lineDocTren)
			map.layers.add(lineNgang)
			map.layers.add(stairs)
			const view = new SceneView({
				container: "viewDiv",
				map: map,
				camera: {
					position: [106.80249, 10.86985,
300],
					heading: 0,
					tilt: 75
				}
			});

			view.popup.defaultPopupTemplateEnabled = true;
		});

	</script>
</head>

<body>
	<div id="viewDiv"></div>
</body>

</html>